@use 'sass:map';
@use '../style/layout-common';

/// Mixin that turns on strong focus indicators.
///
/// @example
///   .my-app {
///     @include mat-strong-focus-indicators($config);
///   }

// Mixin that handles null values for CSS variables
@mixin _create-variable($name, $value) {
  @if ($value) {
    --#{$name}: #{$value};
  }
}

// Mixin to dedup CSS Variables for the strong-focus-indicators mixin
@mixin _strong-focus-indicators-helper($config) {
  $border-style: map.get($config, border-style);
  $border-width: map.get($config, border-width);
  $border-radius: map.get($config, border-radius);
  $border-color: map.get($config, border-color);

  @include _create-variable('mat-focus-indicator-border-style-custom', $border-style);
  @include _create-variable('mat-focus-indicator-border-width-custom', $border-width);
  @include _create-variable('mat-focus-indicator-border-radius-custom', $border-radius);
  @include _create-variable('mat-focus-indicator-border-color-custom', $border-color);
}

@mixin strong-focus-indicators($config: ()) {
  // Default focus indicator config.
  $default-config: (
    border-style: solid,
    border-width: 3px,
    border-radius: 4px,
    border-color: black,
  );

  // Merge default config with user config.
  $config: map.merge($default-config, $config);

  @if (&) {
    @include _strong-focus-indicators-helper($config);
  } @else {
    :root {
      @include _strong-focus-indicators-helper($config);
    }
  }

  // Base styles for focus indicators.
  .mat-focus-indicator::before {
    @include layout-common.fill();
    box-sizing: border-box;
    pointer-events: none;
    border: $border-width $border-style transparent;
    border-radius: $border-radius;
  }

  // For all other components, render the focus indicator on focus.
  .mat-focus-indicator:focus::before {
    content: '';
  }
}
