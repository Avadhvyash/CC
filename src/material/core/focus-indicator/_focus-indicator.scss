@import '../theming/theming';

/// Mixin that turns on strong focus indicators.
///
/// @example
///   .my-app {
///     @include mat-strong-focus-indicators();
///   }
@mixin mat-strong-focus-indicators() {
  // Border width of the focus indicators.
  $border-width: 2px;

  // Base styles for the focus indicators.
  .mat-focus-indicator::before {
    border-radius: 4px;
    border: $border-width solid transparent;
    box-sizing: border-box;
    position: absolute;
    pointer-events: none;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }

  // By default, all focus indicators are flush with the bounding box of their
  // host element. For particular elements (listed below), default inset/offset
  // values are necessary to ensure that the focus indicator is sufficiently
  // contrastive and renders appropriately.

  .mat-focus-indicator.mat-button-base::before,
  .mat-focus-indicator.mat-button-base::before,
  .mat-focus-indicator.mat-card::before,
  .mat-focus-indicator.mat-chip::before,
  .mat-focus-indicator.mat-sort-header-button::before {
    margin: $border-width * -2;
  }

  .mat-focus-indicator.mat-calendar-body-cell::before {
    margin: $border-width * -1;
  }

  .mat-focus-indicator.mat-tab-link::before,
  .mat-focus-indicator.mat-tab-label::before {
    margin: $border-width * 2;
  }

  // Render the focus indicator on focus. Defining a pseudo element's
  // content will cause it to render.

  // For checkboxes, radios, and slide toggles, render the focus indicator
  // when the class .cdk-focused is present.
  .cdk-focused.mat-checkbox .mat-focus-indicator::before,
  .cdk-focused.mat-radio-button .mat-focus-indicator::before,
  .cdk-focused.mat-slide-toggle .mat-focus-indicator::before,

  // For options, render the focus indicator when the class .mat-active
  // is present.
  .mat-focus-indicator.mat-option.mat-active::before,

  // For all other components, render the focus indicator on focus.
  .mat-focus-indicator:focus::before {
    content: '';
  }
}

/// Mixin that sets the color of the focus indicators.
///
/// @param {color|map} $themeOrMap
///   If theme, focus indicators are colored on a best-effort basis using the
///   primary theme color and the currentColor. If color, focus indicators are
///   set to that color.
///
/// @example
///   .demo-dark-theme {
///     @include mat-strong-focus-indicators-theme($darkThemeMap);
///   }
///
/// @example
///   .demo-red-theme {
///     @include mat-strong-focus-indicators-theme(#F00);
///   }
@mixin mat-strong-focus-indicators-theme($themeOrColor) {
  @if (type-of($themeOrColor) == 'map') {
    $primary-palette: map_get($themeOrColor, primary);

    // For most components, color the focus indicators with the primary theme
    // color.
    .mat-focus-indicator::before {
      border-color: mat-color($primary-palette, default);
    }

    // For some components, color the focus indicators with the currentColor to
    // ensure it is contrastive.

    // Primary/accent/warn toolbars.
    .mat-toolbar.mat-primary,
    .mat-toolbar.mat-accent,
    .mat-toolbar.mat-warn,

    // Snack bars.
    .mat-snack-bar-container,

    // Primary/accent/warn tabs.
    .mat-tab-group.mat-background-primary,
    .mat-tab-group.mat-background-accent,
    .mat-tab-group.mat-background-warn,
    .mat-tab-header.mat-background-primary,
    .mat-tab-header.mat-background-accent,
    .mat-tab-header.mat-background-warn {
      .mat-focus-indicator::before {
        border-color: currentColor;
      }
    }
  } @else {
    // If a color is passed in, then just use that for all focus indicators.
    .mat-focus-indicator::before {
      border-color: $themeOrColor;
    }
  }
}
